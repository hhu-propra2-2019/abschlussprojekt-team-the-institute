<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{mopslayout :: html(name='Lernportfolio', title='Upload', headcontent=~{:: headcontent}, navigation=~{fragments/navigation:: navigationFragment}, bodycontent=~{:: bodycontent})}">

<head>
    <th:block th:fragment="headcontent">
        <th:block th:insert="fragments/dependencies :: dependencyFragment"></th:block>
    </th:block>
</head>

<body th:fragment="bodycontent">

<h1 class="display-5">Portfolio Vorlage hochladen</h1>

<br>

<form class="input-group w-50" method="POST" enctype="multipart/form-data" th:action="@{/view}">
    <div class="custom-file">
        <input id="INPUT_FILE" class="custom-file-input" name="file" type="file" accept=".adoc,.asciidoc,.asc,.txt"
               oninput="handleUpload()">
        <label id="LABEL_FILE" class="custom-file-label" for="INPUT_FILE">AsciiDoc Datei auswählen</label>
    </div>
    <div class="input-group-append">
        <button id="BUTTON_UPLOAD" class="input-group-text btn" type="submit" disabled
                onclick="startSpinner()">
            <span id="SPINNER_UPLOAD" class="spinner-border spinner-border-sm" hidden></span>
            Hochladen
        </button>
    </div>
</form>

<script>

    function handleUpload() {

        let INPUT_FILE = document.getElementById("INPUT_FILE");
        if (INPUT_FILE.files.length == 0) {
            return;
        }

        let file = INPUT_FILE.files[0];

        let LABEL_FILE = document.getElementById("LABEL_FILE");
        LABEL_FILE.innerHTML = "Datei " + file.name.bold() + " ausgewählt";

        let BUTTON_UPLOAD = document.getElementById("BUTTON_UPLOAD");
        BUTTON_UPLOAD.disabled = false;
        BUTTON_UPLOAD.classList.add("btn-primary")
    }

    function startSpinner() {
        let SPINNER_UPLOAD = document.getElementById("SPINNER_UPLOAD");
        SPINNER_UPLOAD.hidden = false;
    }

</script>

</body>
</html>